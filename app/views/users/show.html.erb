
<div class="container">

  <h1><%= current_user.nickname.capitalize %>'s Stats</h1>
  <div data-controller="form">
    <%= simple_form_for @topic,
      data:  {action: 'submit->form#createCard' , form_target: "form"} do |f| %>
      <div class="d-flex flex-column align-items-center justify-content-center">
        <%= f.input :name,
            input_html: {
              data: {
                form_target: "name"
              }
            }
        %>
        <%= f.input :category,
            input_html: {
              data: {
                toggle_target: "category",
                action: "input->create-game-btn#change",
                form_target: "category"
              }
            } %>
        <%= f.button :submit, "Create topic", id: "topic-submit-button" %>
      </div>
    <% end %>
  </div>


  <%# Display completed games %>
  <h2>Completed games</h2>

  <% count = 0 %>
  <% @display_states_completed.each do |display_states| %>
    <p>
      Your topics were:
      <% @topics_completed[count].each do |topic|%>
        <%= topic.name %> ,
      <% end %>
      you answered <%= @correct_questions_completed[count] %>
      / <%= @completed_games[count].number_of_questions %> questions correctly.
    </p>

    <% count += 1 %>
    <div class="progress-bar">
      <% display_states.each do |d| %>
        <% if d == "correct" %>
          <div class="box answered-true"></div>
        <% elsif d == "incorrect"%>
          <div class="box answered-false"></div>
        <% else %>
          <div class="box answered-empty"></div>
        <% end %>
      <% end %>
    </div>
  <% end %>

  <%# Display open games %>
  <h2>Open games</h2>
  <% count = 0 %>
  <% @display_states_open.each do |display_states| %>
    <p>
      Your topics are:
      <% @topics_open[count].each do |topic|%>
        <%= topic.name %> ,
      <% end %>
      you answered <%= @correct_questions_open[count] %>
      / <%= @open_games[count].number_of_questions %> questions correctly.
    </p>

    <div class="progress-bar">
      <% display_states.each do |d| %>
        <% if d == "correct" %>
          <div class="box answered-true"></div>
        <% elsif d == "incorrect"%>
          <div class="box answered-false"></div>
        <% else %>
          <div class="box answered-empty"></div>
        <% end %>
      <% end %>
      <%= link_to "Resume", game_path(@open_games[count]) %>
      <% count += 1 %>
    </div>
  <% end %>

</div>
